# üîß Pre-commit Setup Guide

**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ **–î–û –∫–æ–º–º–∏—Ç–∞**

---

## ‚ú® –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç?

‚úÖ **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç—ã —Å –æ—à–∏–±–∫–∞–º–∏ –∏–º–ø–æ—Ä—Ç–æ–≤**  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**  
‚úÖ **–ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–¥–∞**  

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
cd tg-bot-10_02
git pull origin main
```

---

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
pip install -r requirements.txt
```

---

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pre-commit —Ö—É–∫–∏

```bash
pre-commit install
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
pre-commit installed at .git/hooks/pre-commit
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
pre-commit run --all-files
```

**–í–æ–∑–º–æ–∂–Ω—ã–π –≤—ã–≤–æ–¥:**
```
check yaml...................................Passed
fix end of files.............................Passed
trim trailing whitespace.....................Passed
check for added large files..................Passed
check for merge conflicts....................Passed
black........................................Passed
isort........................................Passed
flake8.......................................Passed
bandit.......................................Passed
```

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –î–û —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
# –î–æ–±–∞–≤–ª—è–µ—à—å –∫–æ–¥ —Å –æ—à–∏–±–∫–æ–π
echo "from config import MISSING_CONSTANT" > test.py

# –ö–æ–º–º–∏—Ç–∏—à—å
git add test.py
git commit -m "test"

# ‚ùå –ö–æ–º–º–∏—Ç –°–û–ó–î–ê–Å–¢–°–Ø —Å –æ—à–∏–±–∫–æ–π!
```

---

### –ü–û–°–õ–ï —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
# –î–æ–±–∞–≤–ª—è–µ—à—å –∫–æ–¥ —Å –æ—à–∏–±–∫–æ–π
echo "from config import MISSING_CONSTANT" > test.py

# –ö–æ–º–º–∏—Ç–∏—à—å
git add test.py
git commit -m "test"

# ‚úÖ Pre-commit —Ö—É–∫ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
```

**–í—ã–≤–æ–¥:**
```
flake8.......................................Failed
- hook id: flake8
- exit code: 1

test.py:1:1: F401 'config.MISSING_CONSTANT' imported but unused
test.py:1:1: F821 undefined name 'MISSING_CONSTANT'
```

**‚ùå –ö–æ–º–º–∏—Ç –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù!**

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è?

### 1. üêû **Flake8** - –æ—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤

–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç:
- `F401` - –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- `F811` - –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤
- `F821` - –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `F822` - –û—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

---

### 2. üé® **Black** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç:
- –û—Ç—Å—Ç—É–ø—ã (4 –ø—Ä–æ–±–µ–ª–∞)
- –î–ª–∏–Ω—É —Å—Ç—Ä–æ–∫ (100 —Å–∏–º–≤–æ–ª–æ–≤)
- –ü—Ä–æ–±–µ–ª—ã –≤–æ–∫—Ä—É–≥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
- –ö–∞–≤—ã—á–∫–∏ (–¥–≤–æ–π–Ω—ã–µ)

---

### 3. üìö **isort** - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤

–°–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–º–ø–æ—Ä—Ç—ã:
```python
# –î–û
import os
from aiogram import Router
import sys
from config import TIMEZONE

# –ü–û–°–õ–ï
import os
import sys

from aiogram import Router

from config import TIMEZONE
```

---

### 4. üîí **Bandit** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ù–∞—Ö–æ–¥–∏—Ç:
- SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
- –•–∞—Ä–¥–∫–æ–¥–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- –û–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`eval`, `exec`)
- –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

### 5. üìù **Pydocstyle** - docstrings

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
```python
def my_function():
    """–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π docstring
    
    Returns:
        bool: –†–µ–∑—É–ª—å—Ç–∞—Ç
    """
    pass
```

---

## ü§ñ GitHub Actions

**–ë–æ–Ω—É—Å:** –¢–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ GitHub!

**–ü—Ä–∏ –∫–∞–∂–¥–æ–º `git push`:**

1. ‚úÖ **Test Imports** - –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã
2. ‚úÖ **Flake8** - –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
3. ‚úÖ **Black/isort** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. ‚úÖ **Bandit** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –ù–∞ GitHub: `Actions` —Ç–∞–±
- –í PR: –∑–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ ‚úÖ –∏–ª–∏ –∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ ‚ùå

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
```bash
pre-commit run --all-files
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ö—É–∫
```bash
pre-commit run flake8 --all-files
pre-commit run black --all-files
```

### –û–±–Ω–æ–≤–∏—Ç—å —Ö—É–∫–∏
```bash
pre-commit autoupdate
```

### –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!)
```bash
git commit -m "message" --no-verify
```

### –£–¥–∞–ª–∏—Ç—å —Ö—É–∫–∏
```bash
pre-commit uninstall
```

---

## ‚ùì Troubleshooting

### –û—à–∏–±–∫–∞: `pre-commit: command not found`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install pre-commit
```

---

### –û—à–∏–±–∫–∞: `flake8 failed`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ß–∏—Ç–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
2. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–¥
3. –ü–æ–≤—Ç–æ—Ä—è–µ–º `git commit`

**–ü—Ä–∏–º–µ—Ä:**
```
F401 'config.MISSING_CONSTANT' imported but unused
‚Üí –£–¥–∞–ª–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç

F821 undefined name 'MISSING_CONSTANT'
‚Üí –î–æ–±–∞–≤—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –≤ config.py
```

---

### –û—à–∏–±–∫–∞: `black would reformat`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Black –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
black .

# –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–º–∏—Ç
git add .
git commit -m "message"
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ß—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç pre-commit:**

| –ü—Ä–æ–±–ª–µ–º–∞ | –î–û pre-commit | –ü–û–°–õ–ï pre-commit |
|---------|----------------|------------------|
| Import errors | ‚úÖ –ö–æ–º–º–∏—Ç–∏—Ç—Å—è | ‚ùå –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è |
| Undefined vars | ‚úÖ –ö–æ–º–º–∏—Ç–∏—Ç—Å—è | ‚ùå –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è |
| Bad formatting | ‚úÖ –ö–æ–º–º–∏—Ç–∏—Ç—Å—è | ‚úÖ –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
| Security issues | ‚úÖ –ö–æ–º–º–∏—Ç–∏—Ç—Å—è | ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ |
| Trailing spaces | ‚úÖ –ö–æ–º–º–∏—Ç–∏—Ç—Å—è | ‚úÖ –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ |

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏

- [ ] `git pull origin main`
- [ ] `pip install -r requirements.txt`
- [ ] `pre-commit install`
- [ ] `pre-commit run --all-files` (—Ç–µ—Å—Ç)
- [ ] –°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–º–º–∏—Ç
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ö—É–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Pre-commit documentation](https://pre-commit.com/)
- [Black code formatter](https://black.readthedocs.io/)
- [Flake8 linting](https://flake8.pycqa.org/)
- [Bandit security](https://bandit.readthedocs.io/)

---

**–ì–æ—Ç–æ–≤–æ!** üéâ

–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç –±—É–¥–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è** –Ω–∞ –æ—à–∏–±–∫–∏!
