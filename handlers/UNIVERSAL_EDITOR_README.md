# ‚úèÔ∏è Universal Field Editor

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π –≤ –ë–î —á–µ—Ä–µ–∑ –±–æ—Ç.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª—é–±—ã—Ö –ø–æ–ª–µ–π –ë–î
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ç–∏–ø—ã –ø–æ–ª–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- ‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –∞–¥–º–∏–Ω-–º–µ–Ω—é

```python
# keyboards/admin_keyboards.py

ADMIN_MENU = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üìã –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"), KeyboardButton(text="üë• –ö–ª–∏–µ–Ω—Ç—ã")],
        [KeyboardButton(text="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–π")],  # ‚úÖ –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê
        # ...
    ],
    resize_keyboard=True
)
```

### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–æ—É—Ç–µ—Ä

```python
# main.py

from handlers import universal_editor

# –í start_bot()
dp.include_router(universal_editor.router)
```

### 3. –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:
- üìù –£—Å–ª—É–≥–∏ (services)
- üö´ –ü—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (blocked_slots)
- üë§ Username –∞–¥–º–∏–Ω–æ–≤ (admins)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã –ø–æ–ª–µ–π

```python
EDITABLE_FIELDS_CONFIG = {
    "services": {  # –ö–ª—é—á –¥–ª—è callback_data
        "table": "services",  # –ò–º—è —Ç–∞–±–ª–∏—Ü—ã
        "id_field": "id",  # –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
        "fields": {
            "name": {
                "display": "–ù–∞–∑–≤–∞–Ω–∏–µ",  # –¢–µ–∫—Å—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                "type": "text",  # –¢–∏–ø –ø–æ–ª—è
                "max_length": 100  # –ú–∞–∫—Å –¥–ª–∏–Ω–∞
            },
            "duration_minutes": {
                "display": "–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω)",
                "type": "int",  # –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ
                "min": 15,  # –ú–∏–Ω–∏–º—É–º
                "max": 480  # –ú–∞–∫—Å–∏–º—É–º
            }
        },
        "display_name": "–£—Å–ª—É–≥–∏",  # –ò–º—è –≤ –º–µ–Ω—é
        "list_format": "{name} ({duration_minutes}–º, {price})"  # –§–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    }
}
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã

1. **`text`** - –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
   ```python
   {
       "type": "text",
       "max_length": 200  # –ú–∞–∫—Å –¥–ª–∏–Ω–∞
   }
   ```

2. **`int`** - –¶–µ–ª–æ–µ —á–∏—Å–ª–æ
   ```python
   {
       "type": "int",
       "min": 0,  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
       "max": 1000  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
   }
   ```

---

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü

### –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `bookings`

```python
EDITABLE_FIELDS_CONFIG = {
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏ ...
    
    "bookings": {
        "table": "bookings",
        "id_field": "id",
        "fields": {
            "username": {
                "display": "Username –∫–ª–∏–µ–Ω—Ç–∞",
                "type": "text",
                "max_length": 50
            },
            "date": {
                "display": "–î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏",
                "type": "text",  # –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–∏–ø 'date'
                "max_length": 10
            }
        },
        "display_name": "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è",
        "list_format": "{date} {time} - @{username}"
    }
}
```

–í—Å—ë! –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ –º–µ–Ω—é.

---

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —É—Å–ª—É–≥–∏

1. –ê–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–π"
2. –í—ã–±–∏—Ä–∞–µ—Ç "‚úèÔ∏è –£—Å–ª—É–≥–∏"
3. –í—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—É—é —É—Å–ª—É–≥—É –∏–∑ —Å–ø–∏—Å–∫–∞
4. –ù–∞–∂–∏–º–∞–µ—Ç "–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω): 60"
5. –í–≤–æ–¥–∏—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: `90`
6. ‚úÖ –ì–æ—Ç–æ–≤–æ! –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞

–í—Å–µ handlers –ø—Ä–æ–≤–µ—Ä—è—é—Ç `is_admin()`:

```python
if not is_admin(message.from_user.id):
    await message.answer("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞")
    return
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É:

- **text**: –ø—Ä–æ–≤–µ—Ä–∫–∞ `max_length`
- **int**: –ø—Ä–æ–≤–µ—Ä–∫–∞ `min` / `max`

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

```
INFO - Admin 123456 edited services.duration_minutes for record 5: '60' ‚Üí '90'
```

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
handlers/universal_editor.py
‚îú‚îÄ‚îÄ FieldEditStates       # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ EDITABLE_FIELDS_CONFIG  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π
‚îî‚îÄ‚îÄ Handlers:
    ‚îú‚îÄ‚îÄ field_editor_menu()       # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    ‚îú‚îÄ‚îÄ select_field_type()       # –í—ã–±–æ—Ä —Ç–∏–ø–∞ (—Ç–∞–±–ª–∏—Ü—ã)
    ‚îú‚îÄ‚îÄ select_record()           # –í—ã–±–æ—Ä –∑–∞–ø–∏—Å–∏
    ‚îú‚îÄ‚îÄ start_field_edit()        # –í—ã–±–æ—Ä –ø–æ–ª—è
    ‚îú‚îÄ‚îÄ apply_field_edit()        # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ back_to_editor_menu()     # –ù–∞–∑–∞–¥
    ‚îî‚îÄ‚îÄ close_editor()            # –ó–∞–∫—Ä—ã—Ç–∏–µ
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ú–∞–∫—Å–∏–º—É–º 20 –∑–∞–ø–∏—Å–µ–π –≤ —Å–ø–∏—Å–∫–µ**
   - –ü—Ä–∏ –±–æ–ª—å—à–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–µ 20
   - –†–µ—à–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫/–ø–∞–≥–∏–Ω–∞—Ü–∏—é

2. **–¢–æ–ª—å–∫–æ 2 —Ç–∏–ø–∞ –ø–æ–ª–µ–π**
   - –¢–µ–∫—Å—Ç –∏ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å: date, float, bool

3. **–ù–µ—Ç –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –¢–æ–ª—å–∫–æ –ø–æ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–µ
- [ ] –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ ADMIN_MENU
- [ ] –†–æ—É—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ main.py
- [ ] –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø
- [ ] –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞"

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—è –∑–∞–ø–∏—Å–∏
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- [ ] –¢–µ–∫—Å—Ç: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π
- [ ] Int: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–æ–µ
- [ ] Int: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ
- [ ] Int: –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –Ω–µ-—á–∏—Å–ª–æ

### –î–∞–Ω–Ω—ã–µ
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–∞–≤–∏–≥–∞—Ü–∏—è
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –∫–Ω–æ–ø–∫–∞ "–ó–∞–∫—Ä—ã—Ç—å"
- [ ] /cancel –æ—Ç–º–µ–Ω—è–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–∞ `date` (–¥–∞—Ç–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–∞ `float` (–¥–µ—Å—è—Ç–∏—á–Ω—ã–µ —á–∏—Å–ª–∞)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–∞ `bool` (—á–µ–∫–±–æ–∫—Å—ã)
- [ ] –ü–æ–∏—Å–∫ –ø–æ –∑–∞–ø–∏—Å—è–º
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- [ ] –ú–∞—Å—Å–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## ‚ùì FAQ

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ?**  
A: –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ `fields` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ID?**  
A: –ù–µ—Ç, `id_field` –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å.

**Q: –ß—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–ª–æ–∂–Ω–æ–µ –ø–æ–ª–µ?**  
A: –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Ç–∏–ø –≤ `apply_field_edit()`.

**Q: –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø?**  
A: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `is_admin()` –∏–∑ `utils/helpers.py`.

---

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –û–¥–∏–Ω SQL –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- ‚úÖ –û–¥–∏–Ω SQL –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- ‚úÖ –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –õ–∏–º–∏—Ç 50 –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∑–∞–ø—Ä–æ—Å

---

üéâ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**
